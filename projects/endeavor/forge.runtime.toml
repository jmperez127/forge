# FORGE Runtime Configuration for Endeavor
#
# Values prefixed with "env:" are read from environment variables.

# =============================================================================
# Database Configuration
# =============================================================================
[database]
adapter = "embedded"

[database.embedded]
data_dir = ".forge-runtime/data"
port = 5434  # Different port from helpdesk

[database.postgres]
url = "env:DATABASE_URL"
pool_size = 20
ssl_mode = "prefer"

# =============================================================================
# Jobs Configuration
# =============================================================================
[jobs]
backend = "memory"
concurrency = 10

# =============================================================================
# Authentication Configuration
# =============================================================================
[auth]
provider = "password"

[auth.password]
algorithm = "bcrypt"
bcrypt_cost = 12
user_entity = "User"
email_field = "email"
password_field = "password_hash"
registration_fields = ["display_name"]
min_length = 8

[auth.jwt]
secret = "env:JWT_SECRET"
issuer = "endeavor"
expiry_hours = 24
refresh_expiry_hours = 168

# =============================================================================
# Environment-Specific Overrides
# =============================================================================

[environments.development]
# Uses embedded PostgreSQL - no configuration needed

[environments.test]
[environments.test.database]
adapter = "embedded"
[environments.test.database.embedded]
ephemeral = true

[environments.test.jobs]
backend = "memory"

[environments.production]
[environments.production.database]
adapter = "postgres"
[environments.production.database.postgres]
url = "env:DATABASE_URL"
pool_size = 50
ssl_mode = "require"

[environments.production.jobs]
backend = "redis"
url = "env:REDIS_URL"
concurrency = 20
